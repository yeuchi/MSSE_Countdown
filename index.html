<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>MSSE Class 2017: Spring</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
        <link rel="stylesheet" href="default.css" />
        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

        <!-- Add your site or application content here -->
        
        <div class="divAttr">
            <div class="divLeft">
                Enter Date: <input class="inDate" type="text" name="fname">
     
            </div>
            
            <div class="divRight">
                <p class="daysRemain"></p>
                <p class="hoursRemain"></p>
                <p class="minutesRemain"></p>
                <p class="percentRemain"></p>
            </div>
        </div>
        
        <!--<script src="jquery-1.9.1.min.js"></script>-->
        <script src="http://code.jquery.com/jquery-3.1.1.js"></script>
        <script src="http://d3js.org/d3.v3.min.js"></script>
        <script src="ErrorLog.js"></script>
        <script src="Event.js"></script>
        <script src="DateInput.js"></script>
        <script src="Calendar.js"></script>
        <script src="ClassSession.js"></script>
        <script src="ClassDay.js"></script>
        <script src="Model.js"></script>
        <script src="DownCount.js"></script>

        <script>
            // exercise on ES6 -- MSSE down counter for last semester
            // prior -- ES6 class, scope & var differences, 'let', getter, setter
            // 12/26/2016 -- Class extends & Windows.error()
            // 12/27/2016 -- Mike Bostock's D3 js Calendar view
            // 12/28/2016 -- private members (not available yet)
            // 12/29/2016 -- text field auto populate
            $(document).ready(function() {
                
                // instantiate objects
                let errorLog = new ErrorLog();
                let event = new Event();
                let model = new Model();
                let dateInput = new DateInput(".inDate");
                let calendar = new CalendarView();
                
                // load input file
                model.openJsonFile("schedule.json");
                
                // post data load
                function OnCompleteMarshalHandler(msg, event) {
                    
                    if(model.marshal(event.data))
                    {
                        // calculate time remaining
                        let downCount = new DownCount(model);
                        
                        // days remaining
                        $(".daysRemain").text(("Days remain: "+downCount.daysRemain));
                        
                        // hours remaining
                        $(".hoursRemain").text(("Hours remain: "+downCount.hoursRemain));
                        
                        // minutes remaining
                        $(".minutesRemain").text(("Minutes remain: "+downCount.minutesRemain));
                        
                        // percent remaining -- draw a bar 
                        $(".PercentRemain").text(("Percent remain: "+downCount.percentRemain));
                        
                        calendar.render(model.data4D3);
                    }
                }
                
                // known error
                function OnLoadErrorHandler(msg, event) {
                    errorLog.push(event.data, event.classFunction, event.lineNumber);
                }
                
                // unexpected error
                window.onerror = function (errorMsg, url, lineNumber) {
                    errorLog.push(errorMsg, url, lineNumber);
                }
                
                $(document).bind(event.OnCompleteMarshal, OnCompleteMarshalHandler); 
                $(document).bind(event.OnLoadError, OnLoadErrorHandler); 
            });
            
        </script>
    </body>
</html>
